/*
 * 	 Author: Mert YassÄ±
 * 	 Title : A 4 way SIMD Implementation of SIDH Compatible
 * 	 			Isogeny Evaluations on Kummer Surfaces
 *   Date  : 14.05.2019
 *
 */
const vec vmask0 = {0UL, 0UL, 0UL, 0UL};
const vec vmask1 = {1UL, 1UL, 1UL, 1UL};
const vec vmask7 = {0x7f, 0x7f, 0x7f, 0x7f};
const vec vmask14 = {0x3fff, 0x3fff, 0x3fff, 0x3fff};
const vec vmask24 = {0xffffff, 0xffffff, 0xffffff, 0xffffff};
const vec vmaskB = {(1 << 24), (1 << 24), (1 << 24), (1 << 24)};

vec K3[32] = {	// Precomputed Kummer surface constant
	{ 0x0042B812, 0x00CB2E3E, 0x00440554, 0x00440554 }, { 0x00502FB0, 0x00BC2EB9, 0x00ED28A1, 0x00ED28A1 }, { 0x005371A3, 0x0009DE60, 0x000FC409, 0x000FC409 }, { 0x00216943, 0x00AFA5EF, 0x00410BF2, 0x00410BF2 },
	{ 0x003E5723, 0x0096D351, 0x00730180, 0x00730180 }, { 0x00CEFCE0, 0x00AA5282, 0x000FC358, 0x000FC358 }, { 0x00D8D083, 0x00C72A8E, 0x00EFACC9, 0x00EFACC9 }, { 0x0028780E, 0x007C003E, 0x000EBA4B, 0x000EBA4B },
	{ 0x00A3E154, 0x004EE557, 0x007C32F1, 0x007C32F1 }, { 0x00374A6E, 0x00EC9422, 0x003F3D47, 0x003F3D47 }, { 0x00C54318, 0x00D3254C, 0x009AF3D7, 0x009AF3D7 }, { 0x000B628A, 0x007CFF27, 0x0013D635, 0x0013D635 },
	{ 0x0031F593, 0x00EFD055, 0x0012FC75, 0x0012FC75 }, { 0x004F09DE, 0x0070EB61, 0x009DC481, 0x009DC481 }, { 0x00D375FA, 0x00E8E53C, 0x00F7F68A, 0x00F7F68A }, { 0x0038B134, 0x00877D4F, 0x009251DB, 0x009251DB },
	{ 0x0014BBFD, 0x00A40AA5, 0x0053B880, 0x0053B880 }, { 0x009D400F, 0x006C288B, 0x0096BE63, 0x0096BE63 }, { 0x007F8640, 0x00F2E4F4, 0x004AB578, 0x004AB578 }, { 0x008F3886, 0x0062BE66, 0x003EB937, 0x003EB937 },
	{ 0x0016BA55, 0x00A30232, 0x00C89AC5, 0x00C89AC5 }, { 0x00C47523, 0x001F569E, 0x00730BAF, 0x00730BAF }, { 0x00FC6811, 0x00D48BC9, 0x00ABFC8E, 0x00ABFC8E }, { 0x00D9FA8A, 0x005A5657, 0x0028D789, 0x0028D789 },
	{ 0x002EE0BF, 0x00127861, 0x009D428A, 0x009D428A }, { 0x00791E0A, 0x004A7291, 0x0061EC59, 0x0061EC59 }, { 0x000DE7C3, 0x0020B806, 0x006150F7, 0x006150F7 }, { 0x00D0C3BA, 0x0070575D, 0x009D6779, 0x009D6779 },
	{ 0x00B22E95, 0x00F792E2, 0x00E03618, 0x00E03618 }, { 0x00988AAF, 0x00C6C5DD, 0x00818F3A, 0x00818F3A }, { 0x0006EC3C, 0x00675A7B, 0x0079E232, 0x0079E232 },	{ 0x00000013, 0x00000009, 0x0000000D, 0x0000000D }};

vec K4[32] = {	// Precomputed Kummer surface constant
	{ 0x00BC05FC, 0x00AC4E9E, 0x009A454F, 0x009A454F }, { 0x001952C1, 0x00A38407, 0x00E9CF09, 0x00E9CF09 }, { 0x003B7D28, 0x00DBD142, 0x00583D66, 0x00583D66 }, { 0x008DB1A2, 0x00D01D16, 0x00A22281, 0x00A22281 },
	{ 0x003DD22D, 0x00D793CE, 0x00AF3DD1, 0x00AF3DD1 }, { 0x00883FB7, 0x00862EC2, 0x00EE54D6, 0x00EE54D6 }, { 0x00C70099, 0x001CF4ED, 0x0026CCF2, 0x0026CCF2 }, { 0x00767D9D, 0x008812AC, 0x00751E5F, 0x00751E5F },
	{ 0x00BAA9E1, 0x004B368D, 0x000B24EC, 0x000B24EC }, { 0x003A41AB, 0x00E1CD8F, 0x004EF0E0, 0x004EF0E0 }, { 0x000B3D3E, 0x00720FD3, 0x0088A4DD, 0x0088A4DD }, { 0x00D2F891, 0x004C48FF, 0x00F9C6E4, 0x00F9C6E4 },
	{ 0x007B2692, 0x0071BDE5, 0x00DE0EC9, 0x00DE0EC9 }, { 0x00113B3A, 0x0051109F, 0x00EE9623, 0x00EE9623 }, { 0x0047AFF4, 0x0092992C, 0x0048DEAC, 0x0048DEAC }, { 0x001D01AE, 0x00AFABF1, 0x00C90EB3, 0x00C90EB3 },
	{ 0x00A64267, 0x00237DA2, 0x006600D0, 0x006600D0 }, { 0x0099DE9B, 0x00B89BB6, 0x00A6F3CD, 0x00A6F3CD }, { 0x00BA6856, 0x00018782, 0x00B205ED, 0x00B205ED }, { 0x00D779F6, 0x00A8A221, 0x00AA6667, 0x00AA6667 },
	{ 0x005EF048, 0x009268D9, 0x00F4AB90, 0x00F4AB90 },	{ 0x003B3DDB, 0x00645B0E, 0x00B75EBA, 0x00B75EBA }, { 0x00100E0B, 0x00FF665A, 0x00503EE7, 0x00503EE7 }, { 0x00C7A96E, 0x00B926B7, 0x00A268FC, 0x00A268FC },
	{ 0x00B9126B, 0x000A3EED, 0x0021F61D, 0x0021F61D },	{ 0x0099373E, 0x00AC4466, 0x003A40F8, 0x003A40F8 }, { 0x000167F5, 0x00FC7B33, 0x007750E0, 0x007750E0 }, { 0x000A0E5B, 0x009233C8, 0x00D487C8, 0x00D487C8 },
	{ 0x00DF0E76, 0x00EAA379, 0x005AE689, 0x005AE689 },	{ 0x001EC4B6, 0x00BA6F50, 0x005D2656, 0x005D2656 }, { 0x008AB945, 0x00EAC8A8, 0x009F935E, 0x009F935E }, { 0x00000023, 0x00000027, 0x00000046, 0x00000046 }};

vec P[32] = {	// Precomputed Kummer point
	{ 0x00780BFA, 0x0061EEC3, 0x009641DA, 0x00000001 }, { 0x00AA4666, 0x00C994D2, 0x009EF679, 0x00000000 }, { 0x0018B405, 0x00E28E34, 0x003F890B, 0x00000000 }, { 0x00BBACA1, 0x007EFA7A, 0x00A83E02, 0x00000000 },
	{ 0x002CA07F, 0x0074B09B, 0x007CFEA2, 0x00000000 },	{ 0x0056BB23, 0x008FD46D, 0x00FFA3D9, 0x00000000 }, { 0x00054B75, 0x00FC44A3, 0x0099BCD8, 0x00000000 }, { 0x00205C45, 0x005A5827, 0x0054730E, 0x00000000 },
	{ 0x006C8161, 0x00972987, 0x001EC58E, 0x00000000 },	{ 0x00C55CB4, 0x001DAE00, 0x00443954, 0x00000000 }, { 0x00B14D05, 0x001B264E, 0x00786A9E, 0x00000000 }, { 0x001010CE, 0x00C727B6, 0x007C406A, 0x00000000 },
	{ 0x00626AF0, 0x00AEE5A5, 0x00303A8E, 0x00000000 },	{ 0x0050FA16, 0x0055C314, 0x00661AB8, 0x00000000 }, { 0x006CB088, 0x008F24FF, 0x0068BFD7, 0x00000000 }, { 0x00BBAC0D, 0x009EA129, 0x007B9583, 0x00000000 },
	{ 0x0074E928, 0x0042DD90, 0x00207728, 0x00000000 },	{ 0x00C61CC3, 0x00EC268D, 0x00F4D3CF, 0x00000000 },	{ 0x00E3575C, 0x00287D6F, 0x00F08116, 0x00000000 }, { 0x00D79DEF, 0x0001061C, 0x00557056, 0x00000000 },
	{ 0x00403512, 0x0056517E, 0x007D4F99, 0x00000000 },	{ 0x00336A4B, 0x005E8CF5, 0x0022801A, 0x00000000 }, { 0x0003DA19, 0x00B80AF3, 0x00C056C6, 0x00000000 }, { 0x000BC8EF, 0x0068EC96, 0x0045DD81, 0x00000000 },
	{ 0x0061E461, 0x00CACDEB, 0x00612C5C, 0x00000000 },	{ 0x002A2AB4, 0x00AE6C3D, 0x0022DE3D, 0x00000000 }, { 0x0050EBF3, 0x008513D4, 0x0008A463, 0x00000000 },	{ 0x00E9C8F8, 0x007D3E95, 0x00C1813E, 0x00000000 },
	{ 0x00B172FC, 0x00F126A1, 0x001B131D, 0x00000000 }, { 0x006D24C6, 0x008E2C4E, 0x00568148, 0x00000000 }, { 0x0001EA92, 0x004EC696, 0x00148928, 0x00000000 }, { 0x0000003E, 0x00000044, 0x00000016, 0x00000000 }};

/*----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

vec M[32] = {  // M = 2^372*3^239-1 = p751
	{ 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF },
	{ 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF },
	{ 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF },
	{ 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF, 0x00FFFFFF }, { 0x00EEAFFF, 0x00EEAFFF, 0x00EEAFFF, 0x00EEAFFF },
	{ 0x00F878A8, 0x00F878A8, 0x00F878A8, 0x00F878A8 }, { 0x00968549, 0x00968549, 0x00968549, 0x00968549 }, { 0x0076E3EC, 0x0076E3EC, 0x0076E3EC, 0x0076E3EC }, { 0x0013F7CC, 0x0013F7CC, 0x0013F7CC, 0x0013F7CC },
	{ 0x00959B1A, 0x00959B1A, 0x00959B1A, 0x00959B1A }, { 0x00E876DA, 0x00E876DA, 0x00E876DA, 0x00E876DA }, { 0x0067D6EB, 0x0067D6EB, 0x0067D6EB, 0x0067D6EB }, { 0x00084E98, 0x00084E98, 0x00084E98, 0x00084E98 },
	{ 0x00B25748, 0x00B25748, 0x00B25748, 0x00B25748 }, { 0x00B5045C, 0x00B5045C, 0x00B5045C, 0x00B5045C }, { 0x00668562, 0x00668562, 0x00668562, 0x00668562 }, { 0x0097BADC, 0x0097BADC, 0x0097BADC, 0x0097BADC },
	{ 0x0012909F, 0x0012909F, 0x0012909F, 0x0012909F }, { 0x00F71C0E, 0x00F71C0E, 0x00F71C0E, 0x00F71C0E }, { 0x00E5D541, 0x00E5D541, 0x00E5D541, 0x00E5D541 }, { 0x0000006F, 0x0000006F, 0x0000006F, 0x0000006F }};

vec MM[32] = {  // MM = 2*p751 (for every word)
	{ 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE },
	{ 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE },
	{ 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE },
	{ 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE, 0x01FFFFFE }, { 0x01DD5FFE, 0x01DD5FFE, 0x01DD5FFE, 0x01DD5FFE },
	{ 0x01F0F150, 0x01F0F150, 0x01F0F150, 0x01F0F150 }, { 0x012D0A92, 0x012D0A92, 0x012D0A92, 0x012D0A92 }, { 0x0EDC7D8 , 0x0EDC7D8 , 0x0EDC7D8 , 0x0EDC7D8  }, { 0x027EF98 , 0x027EF98 , 0x027EF98 , 0x027EF98  },
	{ 0x012B3634, 0x012B3634, 0x012B3634, 0x012B3634 }, { 0x01D0EDB4, 0x01D0EDB4, 0x01D0EDB4, 0x01D0EDB4 }, { 0x0CFADD6 , 0x0CFADD6 , 0x0CFADD6 , 0x0CFADD6  }, { 0x0109D30 , 0x0109D30 , 0x0109D30 , 0x0109D30  },
	{ 0x0164AE90, 0x0164AE90, 0x0164AE90, 0x0164AE90 }, { 0x016A08B8, 0x016A08B8, 0x016A08B8, 0x016A08B8 }, { 0x0CD0AC4 , 0x0CD0AC4 , 0x0CD0AC4 , 0x0CD0AC4  }, { 0x012F75B8, 0x012F75B8, 0x012F75B8, 0x012F75B8 },
	{ 0x025213E , 0x025213E , 0x025213E , 0x025213E  }, { 0x01EE381C, 0x01EE381C, 0x01EE381C, 0x01EE381C }, { 0x01CBAA82, 0x01CBAA82, 0x01CBAA82, 0x01CBAA82 }, { 0x0DE     , 0x0DE     , 0x0DE     , 0x0DE      }};

vec C[32] =	{ // C = 2^(2*751) / p751
	{ 0x00CC1191, 0x00CC1191, 0x00CC1191, 0x00CC1191 }, { 0x00914A88, 0x00914A88, 0x00914A88, 0x00914A88 }, { 0x005869A5, 0x005869A5, 0x005869A5, 0x005869A5 },	{ 0x00B6C040, 0x00B6C040, 0x00B6C040, 0x00B6C040 },
	{ 0x00B8FF63, 0x00B8FF63, 0x00B8FF63, 0x00B8FF63 }, { 0x00A5051C, 0x00A5051C, 0x00A5051C, 0x00A5051C }, { 0x00C1978D, 0x00C1978D, 0x00C1978D, 0x00C1978D }, { 0x0020A8B9, 0x0020A8B9, 0x0020A8B9, 0x0020A8B9 },
	{ 0x0002FF88, 0x0002FF88, 0x0002FF88, 0x0002FF88 }, { 0x00E1D47D, 0x00E1D47D, 0x00E1D47D, 0x00E1D47D }, { 0x002A2413, 0x002A2413, 0x002A2413, 0x002A2413 }, { 0x00524CB3, 0x00524CB3, 0x00524CB3, 0x00524CB3 },
	{ 0x00B9FF20, 0x00B9FF20, 0x00B9FF20, 0x00B9FF20 }, { 0x00D7C7C7, 0x00D7C7C7, 0x00D7C7C7, 0x00D7C7C7 }, { 0x00318AFC, 0x00318AFC, 0x00318AFC, 0x00318AFC }, { 0x003DF8E0, 0x003DF8E0, 0x003DF8E0, 0x003DF8E0 },
	{ 0x00F872F7, 0x00F872F7, 0x00F872F7, 0x00F872F7 }, { 0x002F2D1F, 0x002F2D1F, 0x002F2D1F, 0x002F2D1F }, { 0x0009B6FE, 0x0009B6FE, 0x0009B6FE, 0x0009B6FE }, { 0x00B44E18, 0x00B44E18, 0x00B44E18, 0x00B44E18 },
	{ 0x0078A0B9, 0x0078A0B9, 0x0078A0B9, 0x0078A0B9 }, { 0x00187DBE, 0x00187DBE, 0x00187DBE, 0x00187DBE }, { 0x0003D181, 0x0003D181, 0x0003D181, 0x0003D181 }, { 0x003E7DBC, 0x003E7DBC, 0x003E7DBC, 0x003E7DBC },
	{ 0x00972E43, 0x00972E43, 0x00972E43, 0x00972E43 }, { 0x00143DA0, 0x00143DA0, 0x00143DA0, 0x00143DA0 }, { 0x0046097B, 0x0046097B, 0x0046097B, 0x0046097B }, { 0x00E7BAA4, 0x00E7BAA4, 0x00E7BAA4, 0x00E7BAA4 },
	{ 0x00A17781, 0x00A17781, 0x00A17781, 0x00A17781 }, { 0x00FFFB78, 0x00FFFB78, 0x00FFFB78, 0x00FFFB78 }, { 0x006B59F0, 0x006B59F0, 0x006B59F0, 0x006B59F0 }, { 0x00000092, 0x00000092, 0x00000092, 0x00000092 }};
